<html>
    <meta name="viewport" content="width=device-width, initial-scale=1"><style>@media (max-width:480px) {table.table { font-size: 50%; } small { font-size: 50% !important; } table.table td:nth-of-type(n+6), table.table th:nth-of-type(n+6) { display: none; } }</style>
    <head>
    <title>Bonus Point Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>    
    </head>
    <body>
        <div class="mx-auto m-4 p-4 border rounded bg-light" style="max-width: 500px;">
            <h2>Bonus Point Calculator</h2>
            <h5>For English Domestic Cricket</h5>
            <label for="format">Format</label>        
            <select class="form-select" name="format" id="format">
                <option value="T20">T20</option>
                <option value="OD">OD</option>
            </select>
            <label for="overs1">Team 1 Overs</label>
            <input type="number" class="form-control" name="overs1" id="overs1" value="20" />
            <label for="score">Team 1 Score</label>
            <input type="number" class="form-control required border-danger" name="score" id="score" value="" placeholder="Enter Score..." />
            <label for="overs2">Team 2 Overs</label>
            <input type="number" class="form-control" name="overs2" id="overs2" value="20" />
            <label for="target">Team 2 Target</label>
            <input type="number" class="form-control" name="target" id="target" value="" />
            <div class="my-2 text-end">
                <button type="button" class="btn btn-primary" onclick="calc()">Calculate</button>
            </div>        
            <div id="calcs" style="display: none;">
                <h5>Bowling</h5>
                <div>
                    The bowling team need to restrict the batting team to <span class="fw-bold text-success" id="brs"></span>.
                </div>
                <h5 class="mt-2">Batting</h5>
                <div>
                    The batting team need to reach <span id="bos-target"></span> in <span id="bos" class="fw-bold text-success"></span> overs.
                </div>
                <div class="fst-italic text-muted small">
                    <div>
                        Or <span id="bos-target-4"></span> in <span id="bos-4" class="fw-bold"></span> overs with a 4.
                    </div>
                    <div>
                        Or <span id="bos-target-6"></span> in <span id="bos-6" class="fw-bold"></span> overs with a 6.
                    </div>
                </div>
            </div>
        </div>
    </body>
    <script>

        function calc()
        {
            const score = parseFloat($('#score').val());
            const o1 = $('#overs1').val();
            const b1 = balls(o1);
            var rr1 = score / b1 * 6;
            $('#rr1').val(rr1.toFixed(2));
            const o2 = $('#overs2').val();
            const b2 = balls(o2);
            // Bonus Runs
            var brs = rr1 / 1.25;
            $('#brs').text(Math.ceil(brs * o2) - 1);
            var brr = rr1 * 1.25;
            var target = parseInt($('#target').val());
            var bbs = target / brr;
            $('#bos-target').text(target);
            $('#bos').text(overs(dballs(bbs)));
            // Plus... 4
            target += 3;
            bbs = target / brr;
            $('#bos-target-4').text(target);
            $('#bos-4').text(overs(dballs(bbs)));
            // Plus... 6
            target += 2;
            bbs = target / brr;
            $('#bos-target-6').text(target);
            $('#bos-6').text(overs(dballs(bbs)));
            $('#calcs').toggle(true);
        }

        function dballs(overs) {
            const o = Math.floor(overs);
            const db = (overs - o);
            const b = Math.floor(db * 6);
            return parseFloat(parseInt((o * 6) + b));
        }

        function balls(overs)
        {
            const o = Math.floor(overs);
            const b = (overs - o) * 10;
            return parseFloat(parseInt((o * 6) + b));
        }

        function overs(balls)
        {
            const o = Math.floor(balls / 6);
            const b = balls % 6;
            return o + "." + b;
        }

        $( "#format" ).on( "change", function() {
            var o = 20;
            if($(this).val() == 'OD') {
                o = 50;
            }
            $('#overs1').val(o);
            $('#overs2').val(o);
        } );

        $( "#score" ).on( "change", function() {
            var s = parseInt($(this).val());
            $('#target').val(s + 1);
        } );

        $( ".required" ).on( "change keyup", function() {
            var v = parseInt($(this).val());
            console.log(v);
            if(v > 0) {
                $(this).removeClass('border-danger');
            }
            else {
                $(this).addClass('border-danger');
            }
        } );

        $(document).ready(function() {
            const query = new URLSearchParams(window.location.search);
            if(query.get('Score')) {
                $( "#score" ).val(query.get('Score'));
                $( "#score" ).trigger('change');
                calc();
            }
        });

</script>
</html>